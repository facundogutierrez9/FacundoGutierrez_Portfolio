Limpieza Profunda y Estandarización de Registros
Este flujo de trabajo se enfoca en mejorar la calidad de la información mediante la resolución de inconsistencias en nombres de industrias y países. 
Implementa lógica de "self-joins" para completar valores nulos basados en registros existentes y eliminar datos irrelevantes o incompletos para 
asegurar que el análisis posterior sea preciso y confiable.

•	Creación del Entorno de Trabajo - Identificación y Eliminación de Duplicados --------------------------------------------------------

Create table layoff_staging 
like layoffs;

select *
from layoff_staging;

Insert layoff_staging
select *
from layoffs;

select *,
row_number() over (partition by company,industry,total_laid_off,percentage_laid_off,`date`) as row_num
from layoff_staging;

with duplicate_cte as 
(select *,
row_number() over (partition by company,location,industry,total_laid_off,percentage_laid_off,`date`,stage,country,funds_raised_millions) as row_num
from layoff_staging
)
select *
from duplicate_cte
where row_num >1;

•	Estandarización de Texto y Formatos de Fecha --------------------------------------------------------

select distinct industry
from layoff_staging2;

Update layoff_staging2
set company = trim(company);

Select * 
from layoff_staging2
where industry like 'crypto';

select *
from layoff_staging2
where industry like 'crypto%';

update layoff_staging2
set industry = 'crypto'
where industry like 'crypto%';

select distinct country, trim( trailing '.' from country)
from layoff_staging2
where country like 'United states%'
order by 1;

update layoff_staging2
set country = trim( trailing '.' from country)
where country like 'United States%';

select *
from layoff_staging2;

select `date`,
str_to_date(`date`,'%m/%d/%Y')
from layoff_staging2;

update layoff_staging2
set `date` = str_to_date(`date`,'%m/%d/%Y');

select *
from layoff_staging2;

alter table layoff_staging2
modify column `date` date;

•	Tratamiento de Valores Nulos y Limpieza Final --------------------------------------------------------

select *
from layoff_staging2
where total_laid_off is null
and percentage_laid_off is null;

select t1.industry,t2.industry
from layoff_staging2 as t1
join layoff_staging2 as t2
on t1.company = t2.company
where (t1.industry is null or t1.industry ="")
and t2.industry is not null;

update layoff_staging2
set industry = null
where industry = '';

update layoff_staging2 as t1
join layoff_staging2 as t2
on t1.company = t2.company
set t1.industry = t2.company
where t1.industry is null 
and t2.industry is not null;

update layoff_staging2 as t1
join layoff_staging2 as t2
on t1.company = t2.company
set t1.company = 'Airbnb'
where t1.company = "Travel";

select *
from layoff_staging2
where company like "Bally%";

select * 
from layoff_staging2
where industry is null;

call Tabla2();

select * 
from layoff_staging2
where total_laid_off is null 
and percentage_laid_off is null;

delete 
from layoff_staging2
where total_laid_off is null 
and percentage_laid_off is null;

call Tabla2();

alter table layoff_staging2
drop column row_num;

